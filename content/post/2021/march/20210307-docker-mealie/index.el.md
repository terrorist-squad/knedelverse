+++
date = "2021-03-07"
title = "Μεγάλα πράγματα με δοχεία: διαχείριση και αρχειοθέτηση συνταγών στον Synology DiskStation"
difficulty = "level-1"
tags = ["diskstation", "Docker", "docker-compose", "docker-for-desktop", "rezepte", "speisen", "Synology"]
githublink = "https://github.com/terrorist-squad/knedelverse/blob/master/content/post/2021/march/20210307-docker-mealie/index.el.md"
+++
Συγκεντρώστε όλες τις αγαπημένες σας συνταγές στο δοχείο Docker και οργανώστε τις όπως επιθυμείτε. Γράψτε τις δικές σας συνταγές ή εισαγάγετε συνταγές από ιστότοπους, για παράδειγμα "Chefkoch", "Essen
{{< gallery match="images/1/*.png" >}}

## Επιλογή για επαγγελματίες
Ως έμπειρος χρήστης της Synology, μπορείτε φυσικά να συνδεθείτε με SSH και να εγκαταστήσετε ολόκληρη τη ρύθμιση μέσω του αρχείου Docker Compose.
```
version: "2.0"
services:
  mealie:
    container_name: mealie
    image: hkotel/mealie:latest
    restart: always
    ports:
      - 9000:80
    environment:
      db_type: sqlite
      TZ: Europa/Berlin
    volumes:
      - ./mealie/data/:/app/data

```

## Βήμα 1: Αναζήτηση εικόνας Docker
Κάνω κλικ στην καρτέλα "Registration" στο παράθυρο Synology Docker και αναζητώ το "mealie". Επιλέγω την εικόνα Docker "hkotel/mealie:latest" και στη συνέχεια κάνω κλικ στην ετικέτα "latest".
{{< gallery match="images/2/*.png" >}}
Μετά τη λήψη της εικόνας, η εικόνα είναι διαθέσιμη ως εικόνα. Το Docker διακρίνει μεταξύ 2 καταστάσεων, του εμπορευματοκιβωτίου "δυναμική κατάσταση" και της εικόνας/εικόνας (σταθερή κατάσταση). Πριν μπορέσουμε να δημιουργήσουμε ένα δοχείο από την εικόνα, πρέπει να γίνουν μερικές ρυθμίσεις.
## Βήμα 2: Θέστε την εικόνα σε λειτουργία:
Κάνω διπλό κλικ στην εικόνα "mealie".
{{< gallery match="images/3/*.png" >}}
Στη συνέχεια, κάνω κλικ στην επιλογή "Ρυθμίσεις για προχωρημένους" και ενεργοποιώ την "Αυτόματη επανεκκίνηση". Επιλέγω την καρτέλα "Τόμος" και κάνω κλικ στο "Προσθήκη φακέλου". Εκεί δημιουργώ έναν νέο φάκελο με τη διαδρομή προσάρτησης "/app/data".
{{< gallery match="images/4/*.png" >}}
Ορίζω σταθερές θύρες για το εμπορευματοκιβώτιο "Mealie". Χωρίς σταθερές θύρες, θα μπορούσε ο "διακομιστής Mealie" να εκτελείται σε διαφορετική θύρα μετά από επανεκκίνηση.
{{< gallery match="images/5/*.png" >}}
Τέλος, εισάγω δύο μεταβλητές περιβάλλοντος. Η μεταβλητή "db_type" είναι ο τύπος της βάσης δεδομένων και "TZ" είναι η ζώνη ώρας "Europe/Berlin".
{{< gallery match="images/6/*.png" >}}
Μετά από αυτές τις ρυθμίσεις, ο Mealie Server μπορεί να ξεκινήσει! Στη συνέχεια, μπορείτε να καλέσετε τη Mealie μέσω της διεύθυνσης Ip της συσκευής Synology και της θύρας που έχει εκχωρηθεί, για παράδειγμα http://192.168.21.23:8096 .
{{< gallery match="images/7/*.png" >}}

## Πώς λειτουργεί η Mealie;
Αν μετακινήσω το ποντίκι πάνω από το κουμπί "συν" στα δεξιά/κάτω και στη συνέχεια κάνω κλικ στο σύμβολο "αλυσίδα", μπορώ να εισαγάγω ένα url. Στη συνέχεια, η εφαρμογή Mealie αναζητά αυτόματα τις απαιτούμενες μετα- και σχηματικές πληροφορίες.
{{< gallery match="images/8/*.png" >}}
Η εισαγωγή λειτουργεί εξαιρετικά (έχω χρησιμοποιήσει αυτές τις λειτουργίες με urls από το Chef, Food
{{< gallery match="images/9/*.png" >}}
Στη λειτουργία επεξεργασίας, μπορώ επίσης να προσθέσω μια κατηγορία. Είναι σημαντικό να πατάω το πλήκτρο "Enter" μία φορά μετά από κάθε κατηγορία. Διαφορετικά, η ρύθμιση αυτή δεν εφαρμόζεται.
{{< gallery match="images/10/*.png" >}}

## Ειδικά χαρακτηριστικά
Παρατήρησα ότι οι κατηγορίες του μενού δεν ενημερώνονται αυτόματα. Πρέπει να βοηθήσετε εδώ με επαναφόρτωση του προγράμματος περιήγησης.
{{< gallery match="images/11/*.png" >}}

## Άλλα χαρακτηριστικά
Φυσικά, μπορείτε να αναζητήσετε συνταγές και να δημιουργήσετε μενού. Επιπλέον, μπορείτε να προσαρμόσετε το "Mealie" πολύ εκτενώς.
{{< gallery match="images/12/*.png" >}}
Η Mealie φαίνεται επίσης υπέροχη στα κινητά:
{{< gallery match="images/13/*.*" >}}

## Rest-Api
Η τεκμηρίωση του API βρίσκεται στη διεύθυνση "http://gewaehlte-ip:und-port ... /docs". Εδώ θα βρείτε πολλές μεθόδους που μπορούν να χρησιμοποιηθούν για την αυτοματοποίηση.
{{< gallery match="images/14/*.png" >}}

## Παράδειγμα Api
Φανταστείτε την ακόλουθη μυθοπλασία: "Η Gruner und Jahr εγκαινιάζει τη διαδικτυακή πύλη Essen
{{< terminal >}}
wget --spider --force-html -r -l12  "https://www.essen-und-trinken.de/rezepte/archiv/"  2>&1 | grep '/rezepte/' | grep '^--' | awk '{ print $3 }' > liste.txt

{{</ terminal >}}
Στη συνέχεια, καθαρίστε αυτή τη λίστα και εκτοξεύστε την κατά το υπόλοιπο api, παράδειγμα:
```
#!/bin/bash
sort -u liste.txt > clear.txt

while read p; do
  echo "import url: $p"
  curl -d "{\"url\":\"$p\"}" -H "Content-Type: application/json" http://synology-ip:8096/api/recipes/create-url
  sleep 1
done < clear.txt

```
Τώρα μπορείτε επίσης να έχετε πρόσβαση στις συνταγές εκτός σύνδεσης:
{{< gallery match="images/15/*.png" >}}
Συμπέρασμα: Αν αφιερώσετε λίγο χρόνο στο Mealie, μπορείτε να δημιουργήσετε μια μεγάλη βάση δεδομένων συνταγών! Το Mealie αναπτύσσεται συνεχώς ως έργο ανοικτού κώδικα και μπορείτε να το βρείτε στην ακόλουθη διεύθυνση: https://github.com/hay-kot/mealie/

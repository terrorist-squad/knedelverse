+++
date = "2020-02-07"
title = "Организация работы роботов uiPath Windows с помощью Gitlab"
difficulty = "level-5"
tags = ["git", "gitlab", "robot", "roboter", "Robotic-Process-Automation", "rpa", "uipath", "windows"]
githublink = "https://github.com/terrorist-squad/knedelverse/blob/master/content/post/2020/february/20200207-gitlab-uipath/index.ru.md"
+++
UiPath является признанным стандартом в области автоматизации роботизированных процессов. С помощью uiPath вы можете разработать программного робота/робот, который будет выполнять за вас сложные задачи по обработке данных или кликов. Но можно ли управлять таким роботом с помощью Gitlab? Короткий ответ - "да". А как именно, вы можете посмотреть здесь. Для выполнения следующих шагов вам понадобятся права администратора и некоторый опыт работы с uiPath, Windows и Gitlab.
## Шаг 1: Первое, что необходимо сделать, это установить бегунок Gitlab.
1.1.) Создайте нового пользователя Gitlab для вашей целевой операционной системы. Нажмите "Настройки" > "Семья и другие пользователи", а затем "Добавить другого человека на этот ПК".
{{< gallery match="images/1/*.png" >}}
1.2.) Пожалуйста, нажмите "Я не знаю учетных данных этого человека", а затем "Добавить пользователя без учетной записи Microsoft", чтобы создать локального пользователя.
{{< gallery match="images/2/*.png" >}}
1.3.) В следующем диалоге вы можете свободно выбрать имя пользователя и пароль:
{{< gallery match="images/3/*.png" >}}

## Шаг 2: Активация входа в систему обслуживания
Если вы хотите использовать отдельного локального пользователя для вашего Windows Gitlab Runner, то вам необходимо "Активировать вход в систему как службу". Для этого перейдите в меню Windows > "Локальная политика безопасности". Там выберите "Локальная политика" > "Назначить права пользователя" в левой части и "Вход в систему как служба" в правой части.
{{< gallery match="images/4/*.png" >}}
Затем добавьте нового пользователя.
{{< gallery match="images/5/*.png" >}}

## Шаг 3: Зарегистрируйте Gitlab Runner
Программа установки Gitlab Runner для Windows находится на следующей странице: https://docs.gitlab.com/runner/install/windows.html . Я создал новую папку на диске "C" и поместил туда программу установки.
{{< gallery match="images/6/*.png" >}}
3.1.) Я использую команду "CMD" как "Администратор", чтобы открыть новую консоль и перейти в каталог "cd C:\gitlab-runner".
{{< gallery match="images/7/*.png" >}}
Там я вызываю следующую команду. Как вы видите, здесь я также ввожу имя пользователя и пароль пользователя Gitlab.
{{< terminal >}}
gitlab-runner-windows-386.exe install --user ".\gitlab" --password "*****"

{{</ terminal >}}
3.2.) Теперь бегунок Gitlab может быть зарегистрирован. Если вы используете самоподписанный сертификат для установки Gitlab, вы должны предоставить сертификат с атрибутом "-tls-ca-file=". Затем введите url Gitlab и маркер реестра.
{{< gallery match="images/8/*.png" >}}
3.2.) После успешной регистрации runner можно запустить командой "gitlab-runner-windows-386.exe start":
{{< gallery match="images/9/*.png" >}}
Отлично! Ваш Gitlab Runner запущен и может использоваться.
{{< gallery match="images/10/*.png" >}}

## Шаг 4: Установите Git
Поскольку программа Gitlab runner работает с версионностью Git, необходимо также установить Git для Windows:
{{< gallery match="images/11/*.png" >}}

## Шаг 5: Установите UiPath
Установка UiPath - самая простая часть этого руководства. Войдите в систему как пользователь Gitlab и установите версию для сообщества. Конечно, вы можете сразу установить все программное обеспечение, необходимое вашему роботу, например: Office 365.
{{< gallery match="images/12/*.png" >}}

## Шаг 6: Создайте проект Gitlab и конвейер
Теперь наступает грандиозный финал этого урока. Я создаю новый проект Gitlab и проверяю в нем файлы проекта uiPath.
{{< gallery match="images/13/*.png" >}}
6.1.) Кроме того, я создаю новый файл ".gitlab-ci.yml" со следующим содержимым:
```
build1:
  stage: build
  variables:
    GIT_STRATEGY: clone
  script:
    - C:\Users\gitlab\AppData\Local\UiPath\app-20.10.0-beta0149\UiRobot.exe -file "${CI_PROJECT_DIR}\Main.xaml"

```
Мой программный робот для Windows выполняется непосредственно после фиксации в ветке master:
{{< gallery match="images/14/*.png" >}}
Автоматическим запуском робота можно управлять с помощью опции "Расписания". Большим преимуществом этой комбинации является то, что "роботизированные" проекты и результаты проектов (артефакты) могут централизованно контролироваться, версионироваться и управляться Gitlab вместе с другими "нероботизированными" проектами.

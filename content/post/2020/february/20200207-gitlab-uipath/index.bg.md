+++
date = "2020-02-07"
title = "Оркестриране на uiPath Windows роботи с Gitlab"
difficulty = "level-5"
tags = ["git", "gitlab", "robot", "roboter", "Robotic-Process-Automation", "rpa", "uipath", "windows"]
githublink = "https://github.com/terrorist-squad/knedelverse/blob/master/content/post/2020/february/20200207-gitlab-uipath/index.bg.md"
+++
UiPath е утвърден стандарт в областта на автоматизацията на роботизирани процеси. С помощта на uiPath можете да разработите софтуерно базиран робот/бот, който да се грижи за сложни задачи за обработка на данни или кликване вместо вас. Но може ли такъв робот да се управлява и с Gitlab?Краткият отговор е "да". А как точно, можете да видите тук. За следващите стъпки се нуждаете от администраторски права и известен опит в uiPath, Windows и Gitlab.
## Стъпка 1: Първото нещо, което трябва да направите, е да инсталирате Gitlab runner.
1.1.) Създайте нов потребител на Gitlab за целевата си операционна система. Кликнете върху "Настройки" > "Семейство и други потребители" и след това върху "Добавяне на друг човек към този компютър".
{{< gallery match="images/1/*.png" >}}
1.2.) Щракнете върху "I don't know the credentials for this person" (Не знам пълномощията на това лице) и след това върху "Add user without Microsoft account" (Добавяне на потребител без акаунт в Microsoft), за да създадете локален потребител.
{{< gallery match="images/2/*.png" >}}
1.3.) В следващия диалог можете свободно да изберете потребителското име и паролата:
{{< gallery match="images/3/*.png" >}}

## Стъпка 2: Активиране на служебния вход
Ако искате да използвате отделен локален потребител за вашия Windows Gitlab Runner, трябва да "Активирате влизането като услуга". За целта отидете в менюто на Windows > "Местна политика за сигурност". Там изберете "Local Policy" (Местна политика) > "Assign User Rights" (Присвояване на потребителски права) от лявата страна и "Logon as Service" (Вход като услуга) от дясната страна.
{{< gallery match="images/4/*.png" >}}
След това добавете новия потребител.
{{< gallery match="images/5/*.png" >}}

## Стъпка 3: Регистрирайте Gitlab Runner
Инсталаторът за Windows за Gitlab Runner може да бъде намерен на следната страница: https://docs.gitlab.com/runner/install/windows.html . Създадох нова папка в диска "C" и поставих инсталатора в нея.
{{< gallery match="images/6/*.png" >}}
3.1.) Използвам командата "CMD" като "Администратор", за да отворя нова конзола и да премина към директория "cd C:\gitlab-runner".
{{< gallery match="images/7/*.png" >}}
Там извиквам следната команда. Както можете да видите, тук въвеждам и потребителското име и паролата на потребителя на Gitlab.
{{< terminal >}}
gitlab-runner-windows-386.exe install --user ".\gitlab" --password "*****"

{{</ terminal >}}
3.2.) Сега вече може да се регистрира бегачът на Gitlab. Ако използвате собственоръчно подписан сертификат за инсталацията на Gitlab, трябва да предоставите сертификата с атрибута "-tls-ca-file=". След това въведете URL адреса на Gitlab и токена на регистъра.
{{< gallery match="images/8/*.png" >}}
3.2.) След успешна регистрация програмата може да бъде стартирана с командата "gitlab-runner-windows-386.exe start":
{{< gallery match="images/9/*.png" >}}
Страхотно! Вашият Gitlab Runner е готов за работа и може да се използва.
{{< gallery match="images/10/*.png" >}}

## Стъпка 4: Инсталиране на Git
Тъй като Gitlab runner работи с версиите на Git, трябва да се инсталира и Git за Windows:
{{< gallery match="images/11/*.png" >}}

## Стъпка 5: Инсталиране на UiPath
Инсталацията на UiPath е най-лесната част от този урок. Влезте като потребител на Gitlab и инсталирайте изданието за общността. Разбира се, можете веднага да инсталирате целия софтуер, от който се нуждае вашият робот, например: Office 365.
{{< gallery match="images/12/*.png" >}}

## Стъпка 6: Създаване на проект и тръбопровод в Gitlab
Сега идва големият финал на този урок. Създавам нов проект в Gitlab и проверявам файловете на проекта uiPath.
{{< gallery match="images/13/*.png" >}}
6.1.) Освен това създавам нов файл ".gitlab-ci.yml" със следното съдържание:
```
build1:
  stage: build
  variables:
    GIT_STRATEGY: clone
  script:
    - C:\Users\gitlab\AppData\Local\UiPath\app-20.10.0-beta0149\UiRobot.exe -file "${CI_PROJECT_DIR}\Main.xaml"

```
Моят софтуерен робот за Windows се изпълнява директно след предаването му на главния клон:
{{< gallery match="images/14/*.png" >}}
Автоматичното стартиране на робота може да се управлява чрез опцията "Графици". Голямо предимство на тази комбинация е, че "роботизираните" проекти и резултатите от тях (артефакти) могат да бъдат централно контролирани, версията им да бъде управлявана от Gitlab заедно с други "нероботизирани" проекти.

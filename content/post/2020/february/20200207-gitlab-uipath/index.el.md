+++
date = "2020-02-07"
title = "Ενορχήστρωση ρομπότ uiPath Windows με το Gitlab"
difficulty = "level-5"
tags = ["git", "gitlab", "robot", "roboter", "Robotic-Process-Automation", "rpa", "uipath", "windows"]
githublink = "https://github.com/ChristianKnedel/knedelverse/blob/main/content/post/2020/february/20200207-gitlab-uipath/index.el.md"
+++
Η UiPath είναι ένα καθιερωμένο πρότυπο στην αυτοματοποίηση ρομποτικών διαδικασιών. Με το uiPath, μπορείτε να αναπτύξετε ένα ρομπότ/ρομπότ βασισμένο σε λογισμικό, το οποίο αναλαμβάνει σύνθετες εργασίες επεξεργασίας δεδομένων ή κλικ για εσάς. Μπορεί όμως ένα τέτοιο ρομπότ να ελεγχθεί και με το Gitlab; Η σύντομη απάντηση είναι "ναι". Και πώς ακριβώς μπορείτε να δείτε εδώ. Για τα παρακάτω βήματα, χρειάζεστε δικαιώματα διαχείρισης και κάποια εμπειρία σε uiPath, Windows και Gitlab.
## Βήμα 1: Το πρώτο πράγμα που πρέπει να κάνετε είναι να εγκαταστήσετε έναν Gitlab runner.
1.1.) Δημιουργήστε έναν νέο χρήστη του Gitlab για το λειτουργικό σύστημα-στόχο σας. Κάντε κλικ στις "Ρυθμίσεις" > "Οικογένεια και άλλοι χρήστες" και στη συνέχεια στο "Προσθήκη άλλου ατόμου σε αυτόν τον υπολογιστή".
{{< gallery match="images/1/*.png" >}}
1.2.) Κάντε κλικ στο "Δεν γνωρίζω τα διαπιστευτήρια για αυτό το άτομο" και στη συνέχεια στο "Προσθήκη χρήστη χωρίς λογαριασμό Microsoft" για να δημιουργήσετε έναν τοπικό χρήστη.
{{< gallery match="images/2/*.png" >}}
1.3.) Στον ακόλουθο διάλογο μπορείτε να επιλέξετε ελεύθερα το όνομα χρήστη και τον κωδικό πρόσβασης:
{{< gallery match="images/3/*.png" >}}

## Βήμα 2: Ενεργοποίηση σύνδεσης στην υπηρεσία
Αν θέλετε να χρησιμοποιήσετε έναν ξεχωριστό, τοπικό χρήστη για το Windows Gitlab Runner, τότε πρέπει να "Ενεργοποιήσετε τη σύνδεση ως υπηρεσία". Για να το κάνετε αυτό, μεταβείτε στο μενού των Windows > "Τοπική πολιτική ασφαλείας". Εκεί, επιλέξτε "Τοπική πολιτική" > "Εκχώρηση δικαιωμάτων χρήστη" στην αριστερή πλευρά και "Σύνδεση ως υπηρεσία" στη δεξιά πλευρά.
{{< gallery match="images/4/*.png" >}}
Στη συνέχεια, προσθέστε τον νέο χρήστη.
{{< gallery match="images/5/*.png" >}}

## Βήμα 3: Εγγραφή του Gitlab Runner
Το πρόγραμμα εγκατάστασης για τα Windows για το Gitlab Runner μπορείτε να το βρείτε στην ακόλουθη σελίδα: https://docs.gitlab.com/runner/install/windows.html . Δημιούργησα ένα νέο φάκελο στο δίσκο "C" και τοποθέτησα εκεί το πρόγραμμα εγκατάστασης.
{{< gallery match="images/6/*.png" >}}
3.1.) Χρησιμοποιώ την εντολή "CMD" ως "Διαχειριστής" για να ανοίξω μια νέα κονσόλα και να αλλάξω σε έναν κατάλογο "cd C:\gitlab-runner".
{{< gallery match="images/7/*.png" >}}
Εκεί καλώ την ακόλουθη εντολή. Όπως μπορείτε να δείτε, εδώ εισάγονται επίσης το όνομα χρήστη και ο κωδικός πρόσβασης του χρήστη του Gitlab.
{{< terminal >}}
gitlab-runner-windows-386.exe install --user ".\gitlab" --password "*****"

{{</ terminal >}}
3.2.) Τώρα μπορεί να καταχωρηθεί ο δρομέας του Gitlab. Εάν χρησιμοποιείτε ένα αυτο-υπογεγραμμένο πιστοποιητικό για την εγκατάσταση του Gitlab, πρέπει να δώσετε το πιστοποιητικό με το χαρακτηριστικό "-tls-ca-file=". Στη συνέχεια, εισαγάγετε το url του Gitlab και το διακριτικό μητρώου.
{{< gallery match="images/8/*.png" >}}
3.2.) Μετά την επιτυχή εγγραφή, ο δρομέας μπορεί να ξεκινήσει με την εντολή "gitlab-runner-windows-386.exe start":
{{< gallery match="images/9/*.png" >}}
Υπέροχα! Το Gitlab Runner σας είναι λειτουργικό και μπορεί να χρησιμοποιηθεί.
{{< gallery match="images/10/*.png" >}}

## Βήμα 4: Εγκαταστήστε το Git
Δεδομένου ότι ένας δρομέας του Gitlab λειτουργεί με την έκδοση του Git, πρέπει επίσης να εγκατασταθεί το Git for Windows:
{{< gallery match="images/11/*.png" >}}

## Βήμα 5: Εγκαταστήστε το UiPath
Η εγκατάσταση του UiPath είναι το ευκολότερο μέρος αυτού του σεμιναρίου. Συνδεθείτε ως χρήστης του Gitlab και εγκαταστήστε την έκδοση της κοινότητας. Φυσικά, μπορείτε να εγκαταστήσετε αμέσως όλο το λογισμικό που χρειάζεται το ρομπότ σας, για παράδειγμα: Office 365.
{{< gallery match="images/12/*.png" >}}

## Βήμα 6: Δημιουργία έργου και αγωγού Gitlab
Τώρα έρχεται το μεγάλο φινάλε αυτού του σεμιναρίου. Δημιουργώ ένα νέο έργο Gitlab και ελέγχω τα αρχεία του έργου uiPath.
{{< gallery match="images/13/*.png" >}}
6.1.) Επιπλέον, δημιουργώ ένα νέο αρχείο ".gitlab-ci.yml" με το ακόλουθο περιεχόμενο:
```
build1:
  stage: build
  variables:
    GIT_STRATEGY: clone
  script:
    - C:\Users\gitlab\AppData\Local\UiPath\app-20.10.0-beta0149\UiRobot.exe -file "${CI_PROJECT_DIR}\Main.xaml"

```
Το ρομπότ του λογισμικού μου για Windows εκτελείται αμέσως μετά τη δέσμευση στον κύριο κλάδο:
{{< gallery match="images/14/*.png" >}}
